{
  "$schema": "https://docs.renovatebot.com/renovate-schema.json",
  "extends": [
    "github>red-hat-data-services/konflux-central//renovate/default-renovate.json"
  ],
  "enabledManagers": ["dockerfile", "tekton", "custom.regex"],
  "baseBranches": [
    "/^main$|^rhoai-.*$/"
  ],
  "packageRules": [
    {
      "enabled": false,
      "matchPackageNames": [
        "*"
      ]
    },
    {
      "matchPackageNames": [
        "quay.io/aipcc/base-images/cpu"
      ],
      "enabled": true,
      "groupName": "base-image",
      "matchBaseBranches": [
        "main"
      ]
    },
    {
      "matchPackageNames": [
        "quay.io/aipcc/base-images/cpu"
      ],
      "enabled": true,
      "groupName": "base-image",
      "allowedVersions": "/^3\\..*$/",
      "matchBaseBranches": [
        "/^rhoai-.*$/"
      ]
    },
    {
      "matchPackageNames": [
        "llama-stack"
      ],
      "enabled": true,
      "groupName": "llama-stack-version",
      "matchBaseBranches": [
        "main"
      ]
    },
    {
      "matchPackageNames": [
        "llama-stack"
      ],
      "enabled": true,
      "groupName": "llama-stack-version",
      "matchBaseBranches": [
        "/^rhoai-.*$/"
      ]
    },
    {
      "matchPackageNames": [
        "redhat/rhel-ai/llama-stack/pipeline"
      ],
      "enabled": true,
      "groupName": "wheel-releases",
      "matchBaseBranches": [
        "main"
      ]
    },
    {
      "matchPackageNames": [
        "redhat/rhel-ai/llama-stack/pipeline"
      ],
      "enabled": true,
      "groupName": "wheel-releases",
      "matchBaseBranches": [
        "/^rhoai-.*$/"
      ]
    }
  ],
  "customManagers": [
    {
      "customType": "regex",
      "managerFilePatterns": [
        "konflux/cpu-ubi9.conf"
      ],
      "matchStrings": [
        "BASE_IMAGE=(?<depName>.*):(?<currentValue>.*)"
      ],
      "depNameTemplate": "quay.io/aipcc/base-images/cpu",
      "datasourceTemplate": "docker",
      "versioningTemplate": "redhat"
    },
    {
      "customType": "regex",
      "managerFilePatterns": [
        "konflux/cpu-ubi9.conf"
      ],
      "matchStrings": [
        "LLAMA_STACK_VERSION=(?<currentValue>.*)"
      ],
      "datasourceTemplate": "pypi",
      "depNameTemplate": "llama-stack",
      "versioningTemplate": "pep440"
    },
    {
      "customType": "regex",
      "managerFilePatterns": [
        "konflux/cpu-ubi9.conf"
      ],
      "matchStrings": [
        "WHEEL_RELEASE_AARCH64=(?<currentValue>.*)"
      ],
      "datasourceTemplate": "gitlab-releases",
      "depNameTemplate": "redhat/rhel-ai/llama-stack/pipeline",
      "versioningTemplate": "regex:^(?P<major>\\d+)\\.(?P<minor>\\d+)\\.(?P<patch>\\d+)\\+llama-stack-cpu-ubi9-aarch64"
    },
    {
      "customType": "regex",
      "managerFilePatterns": [
        "konflux/cpu-ubi9.conf"
      ],
      "matchStrings": [
        "WHEEL_RELEASE_X86_64=(?<currentValue>.*)"
      ],
      "datasourceTemplate": "gitlab-releases",
      "depNameTemplate": "redhat/rhel-ai/llama-stack/pipeline",
      "versioningTemplate": "regex:^(?P<major>\\d+)\\.(?P<minor>\\d+)\\.(?P<patch>\\d+)\\+llama-stack-cpu-ubi9-x86_64"
    }
  ]
}

